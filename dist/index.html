<meta charset="utf8"><style>body,html{margin:0;padding:0;background-color:#000}div{position:absolute;top:0;bottom:0;left:0;right:0}#canvas{width:100%;height:100%}</style><div><canvas id="canvas"></canvas></div><script>!function(){"use strict";const e={init(){this.t={x:0,y:0,z:0}},e(){this.t=v.i.t}},t={async init(){await new Promise((e=>{let s=new Image;s.onload=e,s.src=t.data.uri,t.o=s}))},data:{uri:"data:image/png;base64,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"}},s=44100;function i({h:e,l:t},i={}){const n=i.u||new AudioContext;let h=e.split("\n"),o=t.split("\n"),r=0;const a=(e,t,s)=>parseInt(e.substr(t,s),16),l=e=>e+.5|0,c=[e=>Math.abs(2*e-1)-1,e=>.5*(e<.9?2*e/.9-1:2*(1-e)/(1-.9)-1),e=>.6*(e<.5?e:e-1),e=>e<.5?.5:-.5,e=>e<.3?.5:-.5,e=>(e<.5?3-Math.abs(24*e-6):1-Math.abs(16*e-12))/9,()=>{const e=2*Math.random()-1,t=(r+.02*e)/1.02;return r=t,10*t},(e,t)=>{const s=(e+.5*Math.abs(t/128%1*2-1))%1;return(Math.abs(4*s-2)-Math.abs(8*e-4))/6}],u=e=>65*2**(e/12),f={},d=(e,t,i)=>{const n=t+"-"+i;let h=f[n];return h||(h=((e,t,i)=>{const n=e[t],h=a(n,2,2)/120,o=a(n,4,2),r=a(n,6,2)||32,f=r*s,A=new Float32Array(f),w=e=>e+1>=r?o:e+1,g=(e,t,s)=>a(n,8+5*e+t,s);let y,m,k,b,p,v=0,I=0,E=0,B=24,D=u(24),T=-1,Q=-1,O=-1;for(;v<f;){y=g(E,0,2)+i,m=u(y),k=g(E,2,1),b=g(E,3,1)/8,p=g(E,4,1);const t=w(E),n=g(t,0,2)+i,o=g(t,2,1),r=g(t,3,1),a=g(t,4,1);let f=.02;(4===p||k===T&&(y===B||1===p)&&Q>0&&5!==O)&&(f=0);let C=.05;(5===p||k===o&&(y===n||1===a)&&r>0&&4!==a)&&(C=0);const S=l(h*s),R=k>7&&d(e,k-8,i+y-24);let V=0;for(let e=v;e<v+S;e++){const t=(e-v)/S;let i=1;t<f?i=t/f:t>1-C&&(i=(1-t)/C);let n=m,h=b;1===p&&(n=(1-t)*D+t*m,Q>0&&(h=(1-t)*Q+t*b)),2===p&&(n*=1+.02*Math.sin(7.5*t)),3===p&&(n*=1-t),4===p&&(h*=t),5===p&&(h*=1-t),p>=6&&(n=m),I+=n/s,k<8?A[e]+=h*i*c[k](I%1,I):(A[e]+=h*i*R[V],V=(V+1)%R.length)}v+=S,B=y,D=m,T=k,Q=b,O=p,E=w(E)}return A})(e,t,i),f[n]=h),h},A=(e,t,s,i,n,h=0)=>{const o=d(e,n,h);let r=0;for(;s<i;)t[s]+=o[r],r=(r+1)%o.length,s++},w=(e=0)=>{const t=[],i=[];let r=0,c=0,u=o.length-1;for(let n=e;n<=u;n++){const e=o[n],f=a(e,0,2);t[n]=0;for(let s=0;s<4;s++){const i=a(e,3+2*s,2);if(i<h.length){const e=h[i];if(0===a(e,6,2)){t[n]=s;break}}}const d=a(e,3+2*t[n],2),A=h[d],w=a(A,2,2)/120;if(i[n]=l(32*w*s),1==(1&f)&&(r=c),c+=32*w,2==(2&f)){u=n;break}}const f=s*c,d=n.createBuffer(1,f,s),w=d.getChannelData(0);let g=0;for(let t=e;t<=u;t++){const e=o[t],s=i[t];for(let t=0;t<4;t++){const i=a(e,3+2*t,2);i<h.length&&A(h,w,g,g+s,i)}g+=s}const y=n.createBufferSource();return y.buffer=d,y.loop=!0,y.loopStart=r,y};this.l=w,this.A=(e=0)=>{const t=w(e);return t.connect(n.destination),t.start(),t}}const n={l:"00 01424144\n00 01444144\n00 01044147\n00 01044344\n00 01044344\n00 00044344\n01 01040944\n00 01040844\n00 01040944\n00 00040744\n01 01040944\n00 01040844\n00 01040944\n00 00040744\n00 41044344\n02 41044344",h:"011600000f5250f4150f2130f7250f5150f7350f4150f5150f6250f4150f513147250f515157350f4150f7150f5250f4150f5130f7250f5150f7350f4150f5150f6250f4150f2130f7250f515107350f4150f715\n011600000c5250c4150c5150c7250c5150c7350c4150c5150c6250c4150c5150d7250c5150d7350c4150c7150c5250c4150c5150c7250c5150c7350c4150c5150c6250c4150c5150c7250c5150d7350c4150c715\n011600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n011600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n011600000c073000000c043000000c023000000c003000000c073000000c053000000c033000000c013306000c073000000c043000000c023000000c003306000c073000000c053000000c033000000c01330600\n01160000150001200017500120011e002187001700012500150001200017700120011e002185001700012700150001200017500120011e002187001700012500150001200017700120011e0021f5001e0001f700\n011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n01160000157500300015730030001571003000030000300014750030001574003000147300300014710030000c70000000000000000000000000000000000000107300300010740147001075015700107600f760\n011600000c7500c7500f7520000011750117501375012700127501255212750007000d750000000c750000000c740000000c730000000c720000000c710000000000000000000000000000000000000000000000\n011600000c7500c7500f7520000011750117501375012700127501250212740007001173000000127100000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},h={init(){if(this.g)return;this.g=!0;const e=window.AudioContext||window.webkitAudioContext;this.u=new e,setTimeout((()=>{this.m=this.u.createGain(this.u,{gain:0}),this.m.connect(this.u.destination),this.m.gain.linearRampToValueAtTime(1,this.u.currentTime+2),this.p=new i(n,{u:this.u}),this.l=this.p.l(),this.l.connect(this.m),this.l.start()}),1)},k(){}},o={I:{v:11,B:12,T:13,D:14,O:15,s:25,C:26,S:27,R:28,n:29},init(){this.r={},this.a={},this.H={},this.V={},this.M={},this.L={ArrowUp:o.I.v,ArrowLeft:o.I.T,ArrowDown:o.I.B,ArrowRight:o.I.D,KeyC:o.I.O,KeyL:o.I.S,KeyH:o.I.R,KeyI:o.I.C,Enter:o.I.s,Escape:o.I.n},window.addEventListener("keydown",(e=>{let t=this.L[e.code];t&&(this.r[t]=!0,t===o.I.s&&(h.init(),o.F=!0))})),window.addEventListener("keyup",(e=>{let t=this.L[e.code];t&&(this.r[t]=!1)}))},e(){for(let e of Object.values(o.I)){let t=this.r[e];this.a[e]=!this.V[e]&&t,this.H[e]=this.V[e]&&!t,this.a[e]?this.M[e]=1:this.V[e]&&t&&this.M[e]++,this.V[e]=t}}},r={W:[{name:"1F",J:[[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,129,129,129,129,129,129,129,134,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,128,46,46,46,46,46,46,137,129,129,45,129,129,129,129,129,134,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,128,46,46,46,46,46,46,124,46,46,46,46,46,46,46,93,137,129,134,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,128,46,46,166,46,46,168,137,129,129,129,45,135,45,129,129,131,46,132,129,129,134,32,32,32,32,32,32,32,32],[32,32,32,129,129,129,129,129,129,129,138,46,46,46,46,128,46,46,46,46,46,46,46,167,137,129,129,129,45,129,129,138,32],[32,32,32,32,32,32,32,32,32,32,128,46,35,35,46,137,129,135,129,129,129,129,129,129,138,61,61,46,46,46,61,128,32],[32,32,32,32,32,32,32,32,32,133,131,46,35,35,46,128,60,132,46,46,46,46,35,46,128,46,46,46,46,46,46,132,134],[32,32,32,32,32,32,32,32,32,128,46,46,35,35,46,128,46,46,46,46,46,46,46,46,124,46,46,46,46,46,46,38,128],[32,32,32,32,32,32,32,32,32,132,134,46,46,46,46,124,46,46,46,46,46,46,46,46,128,91,46,46,46,46,46,133,131],[32,32,32,32,32,32,32,32,32,32,132,129,129,129,129,138,46,46,46,46,46,46,46,46,137,129,129,145,145,145,129,131,32],[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,132,129,129,129,45,129,129,145,129,131,32,32,32,32,32,32,32,32],[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32]],Y:[[45,3,1,8,5],[43,25,5,8,6],[42,10,4,6,7],[46,10,2,10,3],[44,15,6,10,6],[43,24,5,4,2],[42,9,7,2,3],[41,15,4,10,2],[41,19,3,3,2]],G:[[5,24,8],[9,14,4,2],[3,15,9,2],[14,22,7],[7,10,3,2],[10,13,2,2],[22,6,4,4],[6,19,11,2],[29,16,7,4],[30,31,8],[11,18,3],[23,25,6,4],[24,26,6],[8,3,4],[8,3,3],[8,3,2],[18,9,4],[34,7,4,3],[34,8,4,3],[20,27,10],[20,28,10],[20,29,10],[13,25,9,4],[26,30,6,4],[33,10,8,3],[1,16,4,2],[27,23,5],[21,22,11,4]],X:[],id:0}],bounds:[[0,0],[33,14]],K:[19,9,0],j:[0,"The door is barred by a metal plate, held in place by a series of screws.\nYou could open it with the right tool.","You unscrew several screws and the metal plate clatters to the floor.\n%y%0 You push the door open.","The lock is broken and the door won't budge. With the right tool, you can\nprobably pry it open.","You wedge the knife between the door and frame. With a little effort, you\nforce the broken lock away from the strike plate.\n%y%0 You push the door open.",0,"The front door has jammed behind you and won't budge.",0,"The garage door is heavy and immobile. In the center of the door is\na spray-painted eye, surrounded by rings of tiny symbols. It's hard\nto breathe in this room, it's too small somehow.",0,"It seems to be locked from the other side.","The charred remnants of a rocking chair.\nA half-burnt notebook is resting on the melted seat cushion.","The charred remnants of a rocking chair.","This chair is covered in mildew, but otherwise uninteresting.","A vintage dollhouse. Normally you could open it up and take a look inside,\nbut it's been locked with a small silver padlock.","You carefully unlock the padlock and swing the dollhouse open. Eerily, it\nseems to be a miniature version of the house you stand in. Even the\nfurniture is in the same locations.","The open dollhouse watches you impatiently.","The miniature workbench fits perfectly into a space in the garage. The\ndollhouse accepts your gift eagerly.","A small dresser-drawer is sitting in the corner.\nA small silver key is lying on top, attached to note.","A small dresser-drawer is sitting in the corner.",'The wall is strangely spongy here, more like moss than wallpaper.\nThe phrase "HER CHILDREN" has been spray-painted across the wall.',"An oil painting hangs on the wall, out of place in this shabby room. It\nseems to depict a planet being devoured by... something.\nYou feel that the less you look at it, the better.","A rusty garage shelf.","The shelf is covered with dust, but not much else.","Someone has touched this shelf recently, the dust is noticeably absent.\nA realistic miniature workbench rests on the shelf.","The shelf seems to have been recently used, most of the dust is wiped off.","The shelf is covered with dust, but not much else.","A makeshift altar rests against the back wall. Tiny animal bones and black\nfeathers hang from every corner and crevice.\nA miniature sculpture sits in the middle of the altar.","A makeshift altar rests against the back wall. Tiny animal bones and black\nfeathers hang from every corner and crevice.","The stairs to the second floor are a wreck - you can't go up this way.","A crude, life-sized sculpture of a pregnant woman. One hand rests on her\nbelly, and the other holds an iron knife.\nThe sculpture's grip looks loose - perhaps you could take the knife.","With a tug, the sculpture releases the knife.\n%y%0 You have obtained iron knife.","A crude, life-sized sculpture of a pregnant woman. One hand rests on her\nbelly.",0,0,0,0,0,0,0,0,["STORAGE CLOSET","This storage closet has been converted into some kind of shrine. The\nunpainted wooden walls are carved with words, but none of them make\nany sense to you."],["DINING ROOM","The dining room is dominated by an oak table, which appears to have been\nused recently as a butcher's block. Flies buzz above fresh animal entrails\nlittering the table. The table and the carpet below is soaked in blood."],["DRAWING ROOM","You are in a dimly lit drawing room filled with faded furniture.\nThe room smells of musty upholstery."],["FOYER","You are in the foyer. The peeling paint and threadbare rugs seem even\nolder than the outside of the house.\nA large dollhouse sits on a pedestal in the far corner of the room."],["GARAGE","The garage is empty, save for a few rusty shelves and the usual cobwebs.\nThere must have been other furniture here recently, you can see lines\nin the dust where a workbench used to be."],["CHARRED HALLWAY","There must have been a fire at some point. Soot and grime coat the walls,\nand the air stinks of burnt fabric."],["???","A nice old room.\nWhat a nice place it is.\nFuck it."],0,0,0,["iron knife","A large iron knife etched with\nhundreds of tiny symbols. It feels\nheavy in your hand."],["small silver key",'A small silver key. A note is\nattached with a piece of twine.\n\n"N is still here, stay on this\n side."'],["your uncle's letter",'"Dearest Emily,\n\n We are all in grave danger and\n I am running out of time. I\n cannot explain here but I need\n your help."\n[Several more lines are furiously\ncrossed out and are illegible.]'],["half-burnt notebook",'Most of the pages are too burnt\nto read, but somehow one page\nis crystal clear:\n\n"Our Goddess walks the hills\n in the shadow of the wailing star\n and we follow in her path"'],["miniature workbench","A curiously realistic miniature\nworkbench, made of wood and metal.\nMaybe there's some use for it."],["screwdriver","A rusty, but still functional,\ncrosshead screwdriver."]]},a={Z:46,init(){this.c(),this.P=[]},U(){if(v.f%169>1){let e=this.W[0].J;for(let t=0;t<e.length;t++)for(let s=0;s<e[t].length;s++)if(this.W[0].visible[t][s]){let i=this.N({x:s,y:t,z:0});if(i&&3!==i.type)d.q(s,t,i.char,this.$(i));else{let i=String.fromCharCode(e[t][s]);d.q(s,t,i,this._(i))}}}if(d.write(0,0," ".repeat(64)),d.write(0,1," ".repeat(64)),d.write(0,2," ".repeat(64)),v.i.ee){let e=a.j[v.i.ee.id][0];d.write(Math.floor((64-e.length)/2),1,e,d.te)}},c(){this.W=r.W.map((e=>({J:e.J.map((e=>[...e])),visible:e.J.map((e=>e.map((e=>!1)))),G:e.G.map((e=>({id:e[0],x:e[1],y:e[2],type:e[3]}))),Y:e.Y.map((e=>({id:e[0],x:e[1],y:e[2],width:e[3],height:e[4]}))),X:e.X.map((e=>({...e})))}))),this.bounds=r.bounds,this.K=r.K,this.j=r.j;for(let e of this.W)for(let t of e.G)t.char=String.fromCharCode(e.J[t.y][t.x]),e.J[t.y][t.x]=a.Z},se(e){return this.W[e.z].Y.find((t=>e.x>=t.x&&e.y>=t.y&&e.x<t.x+t.width&&e.y<t.y+t.height))},N(e){return this.W[e.z].G.find((t=>t.x===e.x&&t.y===e.y))},ie(e,t){let s=[];for(let i of this.W)for(let n of i.G)n.id===e&&(s.push(n),t&&t(n,i));return s},ne(e){let t=this.W[e.z].J;return e.x<0||e.y<0||e.x>=t[0].length||e.y>=t.length?" ":t[e.y][e.x]},oe(e){return 46===this.ne(e)},$:e=>e.finished?d.he:e.re?d.ae:d.le,_:e=>"."===e?d.he:d.ce,ue(e){for(let t of this.W)for(let s of t.Y)if(s.id===e)for(let e=s.y;e<s.y+s.height;e++)for(let i=s.x;i<s.x+s.width;i++)t.visible[e][i]=!0}};function l(e,t,s,i){return`rgba(${e},${t},${s},${i})`}function c(e,t){return(""+e).padStart(3," ")+"/"+t}const u={init(){this.fe={},this.fe.de=t.o,u.Ae=t.o,u.we=f(u.Ae,l(67,255,16,1)),u.ge=f(u.Ae,l(51,255,0,.4))},ye(e,s,i,n,h=""){"number"==typeof s&&(s=String.fromCharCode(s));let o=this.fe[h];if(o||(this.fe[h]=o=f(t.o,h)),Array.isArray(s))for(let t of s)u.ye(e,t.text,i+1*t.me,n+1*t.be,o,1);else for(let t=0;t<s.length;t++){let h=s.charCodeAt(t),r=8*(h-0);32!==h&&e.drawImage(o,1*r%o.width,16*Math.floor(1*r/o.width)*1,8,16,i,n,8,16),i+=8}}};function f(e,t){let s=function(e,t){let s=document.createElement("canvas");s.width=e,s.height=t;let i=s.getContext("2d");return{canvas:s,pe:i}}(e.width,e.height);return s.pe.fillStyle=t,s.pe.fillRect(0,0,e.width,e.height),s.pe.globalCompositeOperation="destination-in",s.pe.drawImage(e,0,0),s.canvas}const d={he:0,RED:1,te:2,ae:3,le:4,ke:5,Ie:6,ce:7,ve:8,Ee:32,init(){this.screen=[],this.Be=5,this.clear(),d.Te={[d.he]:l(144,144,144,1),[d.RED]:l(214,69,46,1),[d.te]:l(151,216,122,1),[d.ae]:l(238,212,83,1),[d.le]:l(70,151,226,1),[d.ce]:l(214,214,214,1),[d.ce|d.ve]:l(255,255,255,1)}},clear(e=0,t=0,s=80,i=24){for(let n=t;n<t+i;n++)for(let t=e;t<e+s;t++)this.screen[80*n+t]=d.Ee|d.ce<<8},write(e,t,s,i=d.ce,n=80){if("string"!=typeof s)throw new Error("string");let h=e;for(let o=0;o<s.length;o++){let r=s.charCodeAt(o);if("\n"!==s[o]){if("%"===s[o])switch(s[++o]){case"d":i=d.he;continue;case"r":i=d.RED;continue;case"g":i=d.te;continue;case"b":i=d.le;continue;case"y":i=d.ae;continue;case"w":i=d.ce;continue;case"W":i=d.ce|d.ve;continue;case"0":r=165;break;case"1":r=164;break;default:o--}this.screen[80*t+e]=r|i<<8,++e>=n&&(e=h,t++)}else e=h,t++}},q(t,s,i,n,h){let o=32-e.t.x,r=12-e.t.y;this.write(t+o,s+r,i,n,h)},De(e,t,s,i,n){s>2&&i>2&&d.clear(e+1,t+1,s-2,i-2),this.write(e,t,`${"".repeat(s-2)}`,n),this.write(e,t+i-1,`${"".repeat(s-2)}`,n);for(let h=t+1;h<t+i-1;h++)this.write(e,h,"",n),this.write(e+s-1,h,"",n)},U(e){if(v.f%221>0)for(let t=0;t<24;t++)for(let s=0;s<80;s++){let i=this.screen[80*t+s],n=255&i;32!==n&&n<128&&this.Be>0&&(n+=this.Be),u.ye(e,n,8*s,16*t,d.Te[i>>8])}}},A={init(){this.entries=[]},add(e,t=""){"%"!==e[0]&&(e=t+"¥ "+e),this.entries.push(e.split("\n"))},Oe(e){A.add(`%y%0 You have obtained ${a.j[e][0]}.`)},U(e=3){let t=e+2,s=22-e,i=0;this.entries[this.entries.length-1].length<3&&(i=3-this.entries[this.entries.length-1].length);let n=this.entries.flat();for(;i-- >0;)n.push("");n.length>e&&(n=n.slice(n.length-e)),d.De(0,s,80,t,d.he),d.write(64,s,"",d.he);for(let e=0;e<n.length;e++)d.write(2,s+e+1,n[e])}};class w{constructor(){this.lines=3,this.offset=0}e(){if((o.a[o.I.n]||o.a[o.I.S])&&(this.Qe=!0),this.Qe){if(this.lines-=2,this.lines<=3)return void(this.Ce=!0)}else this.lines<15&&(this.lines+=2),o.a[o.I.v]?this.offset++:o.a[o.I.B]&&this.offset--;this.offset=Math.min(this.offset,0),this.offset=Math.max(this.offset,A.entries.flat().length-this.lines)}U(){d.clear(0,24-this.lines-1,80,this.lines+2),A.U(this.lines,this.offset)}}class g{constructor(){this.expand=2}e(){if((o.a[o.I.n]||o.a[o.I.R])&&(this.Qe=!0),this.Qe){if(this.expand-=2,2===this.expand)return void(this.Ce=!0)}else this.expand<22&&(this.expand+=2)}U(){d.De(2,12-Math.floor(this.expand/2),76,this.expand,d.te),d.write(4,13-Math.floor(this.expand/2),"                                  %gHELP\n\n%gCONTROLS\n  %W ¡¢£    %wMove / Investigate / Attack\n  %WI       %wOpen inventory\n  %WL       %wExpand logbook\n  %WH       %wToggle help (this screen)\n\n%gMAP LEGEND\n  %W@       %wYou\n  %d.       %wEmpty floors\n  %w      %wWalls\n  %b|- %d'    %wDoors (%bclosed%w / %dopen%w)\n  %b< >     %wStairways (up / down)\n\n  %b&!      %wBlue objects can be investigated\n  %y%#      %wYellow objects may need to be revisited later\n  %d=$      %wGray objects have already been investigated\n\n  %rsfVH    %wRed letters are foes".split("\n").slice(0,this.expand).join("\n"))}}class y{constructor(e){this.object=e,this.expand=2,this.selected=0,this.list=v.i.Se}e(){o.a[o.I.n]||o.a[o.I.C]&&!this.object?this.Qe=!0:o.a[o.I.B]?this.selected=(this.selected+1)%this.list.length:o.a[o.I.v]?this.selected=(this.selected+this.list.length-1)%this.list.length:o.a[o.I.s]&&this.object&&(this.Qe=!0,v.i.Re(this.object,this.list[this.selected])),this.Qe&&(this.Ce=!0)}U(){d.De(5,6,71,10,d.te),d.write(38,6,"",d.te),d.write(38,15,"",d.te);for(let e=7;e<15;e++)d.write(38,e,"",d.te);for(let e=0;e<this.list.length;e++){let[t,s]=a.j[this.list[e]];e===this.selected?(d.write(6,7+e,`%0${t.padEnd(30)}%1`,d.te),d.write(40,7,s)):d.write(7,7+e,t)}this.object?d.write(6,14,"[ ¡¢£ENTER] Use item  [ESC] Back",d.he):d.write(6,14,"[ ¡¢£] Examine item   [ESC] Back",d.he)}}class m{constructor(e){this.t={...e},this.He=this.ee,this.Se=[],this.speed=4,this.Ve=this.Me=100,this.Le=this.ze=100,this.Fe(53),a.ie(6,(e=>e.finished=!0)),this.ee=a.se(this.t),A.add(a.j[this.ee.id][1]),a.ue(this.ee.id),this.Fe(51),this.Fe(54),this.Fe(52),this.Fe(56)}U(){d.q(this.t.x,this.t.y,"@",d.ce|d.ve)}e(){let e;return o.V[o.I.T]&&o.M[o.I.T]%2==1?e={...this.t,x:this.t.x-1}:o.V[o.I.D]&&o.M[o.I.D]%2==1?e={...this.t,x:this.t.x+1}:o.V[o.I.v]&&o.M[o.I.v]%2==1?e={...this.t,y:this.t.y-1}:o.V[o.I.B]&&o.M[o.I.B]%2==1&&(e={...this.t,y:this.t.y+1}),e&&this.We(e),!!e}We(e){let t=a.ne(e),s=a.N(e);if(v.Je(e));else if(s&&3!==s.type){if(s.open)this.Ye(e,!1);else if(s.finished)this.He=s,A.add(a.j[s.id]);else if(1===s.id)A.add(a.j[s.id]),s.re&&this.Ge(s);else if(3===s.id)A.add(a.j[s.id]),s.re&&this.Ge(s);else if(5===s.id)this.Xe(s),a.ue(43);else if(10===s.id)A.add(a.j[s.id]);else if(7===s.id)this.Xe(s),a.ue(45);else if(8===s.id)A.add(a.j[s.id]),this.Le-=3,d.Be=4,a.ie(8,(e=>e.finished=!0));else if(9===s.id)this.Xe(s),a.ue(46);else if(11===s.id)A.add(a.j[s.id]),s.id=12;else if(12===s.id)s.finished=!0,A.Oe(54),this.Fe(54);else if(18===s.id)A.add(a.j[s.id]),s.id=19;else if(19===s.id)s.finished=!0,A.Oe(52),this.Fe(52);else if(14===s.id)A.add(a.j[s.id]),s.re&&this.Ge(s);else if(16===s.id)A.add(a.j[s.id]),this.Ge(s);else if(20===s.id)A.add(a.j[s.id]),this.Le--,d.Be=2,a.ie(20,(e=>e.finished=!0));else if(24===s.id)A.add(a.j[s.id]),s.id=25;else if(25===s.id)s.finished=!0,A.Oe(55),this.Fe(55);else if(30===s.id)A.add(a.j[s.id]),s.id=31;else if(31===s.id)A.add(a.j[s.id]),s.id=32,s.finished=!0,this.Le--,this.Fe(51);else if(2===s.type)this.Xe(s);else if(4===s.type)A.add(a.j[s.id]),s.finished=!0,this.Le--;else{let e="";s.action?e=`\n${s.action}`:s.re&&(e="\n%y¥ You need some kind of other item."),this.He=s,A.add(a.j[s.id]+e)}s.re=!0}else t===a.Z&&this.Ye(e,!0)}Ye(e,t){if(this.t=e,t){let e=a.se(this.t);this.ee!==e&&A.add(a.j[e.id][1]),this.ee=e,this.He=this.ee}}Ge(e){v.Ke.push(new y(e))}Re(e,t){1===e.id&&56===t?(this.Xe(e,2),this.Le-=3,a.ue(41)):3===e.id&&51===t?(this.Xe(e,4),a.ue(42)):14===e.id&&52===t?(A.add(a.j[15]),e.id=16,this.removeItem(52)):16===e.id&&55===t?(A.add(a.j[17]),this.removeItem(55),a.ie(34,(e=>{e.type=0,e.char="§"}))):A.add("%y%0 That doesn't work here.")}je(e){return this.Se.includes(e)}Fe(e){this.Se.push(e)}removeItem(e){this.Se=this.Se.filter((t=>t!==e))}Xe(e,t){t?A.add(a.j[t]):A.add("You push the door open.","%y"),e.open=e.finished=!0,e.char="|"===e.char?"'":""}}const k={xe(){const e=[...v.entities];if(v.i.Ze||(v.i.Ze=0),v.i.Ze>=v.i.speed)v.i.e()&&(v.i.Ze-=v.i.speed);else for(let t of e)t.Ze=(t.Ze||0)+1}},b={init(){b.canvas=document.getElementById("canvas"),b.pe=b.canvas.getContext("2d"),b.resize(!0)},resize(e){let t=window.devicePixelRatio,s=b.canvas.clientWidth,i=b.canvas.clientHeight,n=s*t,h=i*t;(e||b.canvas.width!==n||b.canvas.height!==h)&&(b.canvas.width=n,b.canvas.height=h,b.scale=(10*Math.min(n/648,h/400)|0)/10,b.width=Math.ceil(n/b.scale),b.height=Math.ceil(h/b.scale),b.Pe={me:b.width/2|0,be:b.height/2|0},b.clientWidth=s,b.clientHeight=i,b.pe.imageSmoothingEnabled=!1),b.canvas.style.cursor="not-allowed"}};class p{constructor(){this.expand=2,d.Be=26}e(){(o.a[o.I.s]||o.F)&&(this.Qe=!0),this.Qe&&(this.Ce=!0,setTimeout((()=>{d.Be=5}),500))}U(){d.clear(),d.De(4,4,72,15,d.te),d.write(6,5,"                     %gSHADOW OF THE KEENING STAR\n\n%wFor some reason, you just couldn't ignore that letter. It was wrong,\nsomehow - although estranged, you remember your uncle, and he never\nwrote like that.\n\nSo here you are, an hour southeast of Boston, still clutching your\nuncle's letter and standing in front of a weather-beaten colonial.\n\nThe creak of the front door echoes in your ears as you step into the\nhouse...\n\n%d[ENTER] Begin")}}const v={async init(){await t.init(),b.init(),d.init(),u.init(),o.init(),a.init(),A.init(),this.f=0,this.entities=[],this.i=new m(function(e,t,s){return{x:e,y:t,z:s}}(...a.K)),this.entities.push(this.i),this.Ke=[],this.Ke.push(new p),e.init(),window.requestAnimationFrame((()=>this.Ue()))},Ue(){let e=(new Date).getTime();e-(this.Ne||0)>=1e3/60&&(this.f++,this.e(),this.Ne=e,b.resize(),this.U()),window.requestAnimationFrame((()=>this.Ue()))},e(){o.e(),this.Ke.length>0?(this.Ke[this.Ke.length-1].e(),this.Ke=this.Ke.filter((e=>!e.Ce))):o.a[o.I.S]?this.Ke.push(new w):o.a[o.I.R]?this.Ke.push(new g):o.a[o.I.C]?this.Ke.push(new y):k.xe(),e.e(),v.entities=v.entities.filter((e=>!e.Ce)),d.Be>0&&d.Be--},U(){b.pe.setTransform(b.scale,0,0,b.scale,0,0),b.pe.fillStyle="#121212",b.pe.fillRect(0,0,b.width,b.height),b.pe.translate((b.width-648)/2|0,(b.height-400)/2|0),d.clear();for(let e=0;e<20;e++)d.write(64,e,"",d.he);d.write(66,1,`Health ${c(v.i.Ve,v.i.Me)}`),d.write(66,2,`Sanity ${c(v.i.Le,v.i.ze)}`),a.U();for(let e of this.entities)e.z<0&&e.U();for(let e of this.entities)e.z||e.U();for(let e of this.entities)e.z>0&&e.U();d.write(66,18,"[H] Help",d.he),A.U(3);for(let e of this.Ke)e.U();d.U(b.pe)},Je(e){return this.entities.find((t=>t.t.x===e.x&&t.t.y===e.y&&t.t.z===e.z))}};v.init()}();
//# sourceMappingURL=app.js.map</script>
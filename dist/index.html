<meta charset="utf8"><style>body,html{margin:0;padding:0;background-color:#000}div{position:absolute;top:0;bottom:0;left:0;right:0}#canvas{width:100%;height:100%}</style><div><canvas id="canvas"></canvas></div><script>!function(){"use strict";const t={init(){this.t={x:0,y:0,z:0}},update(){this.t=E.i.t}},e=80,s=16,i={async init(){await new Promise((t=>{let e=new Image;e.onload=t,e.src=i.data.uri,i.o=e}))},data:{uri:"data:image/png;base64,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"}},n=44100;function o({h:t,l:e},s={}){const i=s.u||new AudioContext;let o=t.split("\n"),h=e.split("\n"),r=0;const a=(t,e,s)=>parseInt(t.substr(e,s),16),l=t=>t+.5|0,c=[t=>Math.abs(2*t-1)-1,t=>.5*(t<.9?2*t/.9-1:2*(1-t)/(1-.9)-1),t=>.6*(t<.5?t:t-1),t=>t<.5?.5:-.5,t=>t<.3?.5:-.5,t=>(t<.5?3-Math.abs(24*t-6):1-Math.abs(16*t-12))/9,()=>{const t=2*Math.random()-1,e=(r+.02*t)/1.02;return r=e,10*e},(t,e)=>{const s=(t+.5*Math.abs(e/128%1*2-1))%1;return(Math.abs(4*s-2)-Math.abs(8*t-4))/6}],f=t=>65*2**(t/12),u={},d=(t,e,s)=>{const i=e+"-"+s;let o=u[i];return o||(o=((t,e,s)=>{const i=t[e],o=a(i,2,2)/120,h=a(i,4,2),r=a(i,6,2)||32,u=r*n,A=new Float32Array(u),w=t=>t+1>=r?h:t+1,g=(t,e,s)=>a(i,8+5*t+e,s);let y,m,b,k,p,I=0,v=0,E=0,B=24,D=f(24),T=-1,O=-1,Q=-1;for(;I<u;){y=g(E,0,2)+s,m=f(y),b=g(E,2,1),k=g(E,3,1)/8,p=g(E,4,1);const e=w(E),i=g(e,0,2)+s,h=g(e,2,1),r=g(e,3,1),a=g(e,4,1);let u=.02;(4===p||b===T&&(y===B||1===p)&&O>0&&5!==Q)&&(u=0);let C=.05;(5===p||b===h&&(y===i||1===a)&&r>0&&4!==a)&&(C=0);const H=l(o*n),S=b>7&&d(t,b-8,s+y-24);let V=0;for(let t=I;t<I+H;t++){const e=(t-I)/H;let s=1;e<u?s=e/u:e>1-C&&(s=(1-e)/C);let i=m,o=k;1===p&&(i=(1-e)*D+e*m,O>0&&(o=(1-e)*O+e*k)),2===p&&(i*=1+.02*Math.sin(7.5*e)),3===p&&(i*=1-e),4===p&&(o*=e),5===p&&(o*=1-e),p>=6&&(i=m),v+=i/n,b<8?A[t]+=o*s*c[b](v%1,v):(A[t]+=o*s*S[V],V=(V+1)%S.length)}I+=H,B=y,D=m,T=b,O=k,Q=p,E=w(E)}return A})(t,e,s),u[i]=o),o},A=(t,e,s,i,n,o=0)=>{const h=d(t,n,o);let r=0;for(;s<i;)e[s]+=h[r],r=(r+1)%h.length,s++},w=(t=0)=>{const e=[],s=[];let r=0,c=0,f=h.length-1;for(let i=t;i<=f;i++){const t=h[i],u=a(t,0,2);e[i]=0;for(let s=0;s<4;s++){const n=a(t,3+2*s,2);if(n<o.length){const t=o[n];if(0===a(t,6,2)){e[i]=s;break}}}const d=a(t,3+2*e[i],2),A=o[d],w=a(A,2,2)/120;if(s[i]=l(32*w*n),1==(1&u)&&(r=c),c+=32*w,2==(2&u)){f=i;break}}const u=n*c,d=i.createBuffer(1,u,n),w=d.getChannelData(0);let g=0;for(let e=t;e<=f;e++){const t=h[e],i=s[e];for(let e=0;e<4;e++){const s=a(t,3+2*e,2);s<o.length&&A(o,w,g,g+i,s)}g+=i}const y=i.createBufferSource();return y.buffer=d,y.loop=!0,y.loopStart=r,y};this.l=w,this.A=(t=0)=>{const e=w(t);return e.connect(i.destination),e.start(),e}}const h={l:"00 01424144\n00 01444144\n00 01044147\n00 01044344\n00 01044344\n00 00044344\n01 01040944\n00 01040844\n00 01040944\n02 00040744",h:"011600000f5250f4150f2130f7250f5150f7350f4150f5150f6250f4150f513147250f515157350f4150f7150f5250f4150f5130f7250f5150f7350f4150f5150f6250f4150f2130f7250f515107350f4150f715\n011600000c5250c4150c5150c7250c5150c7350c4150c5150c6250c4150c5150d7250c5150d7350c4150c7150c5250c4150c5150c7250c5150c7350c4150c5150c6250c4150c5150c7250c5150d7350c4150c715\n011600000c60012500115000c6000c0002a0002a000290000c60012500115000c6000c0002a00029000240000c60012500115000c6000c00012500115000c5000c5100d0100c7200d02018030195301804019740\n011600000f0300c030115400c0311803212730110400c5300f0300c030117400c0311803212530110400c7300f0300c030115400c0311803212730110400c5300f0300c030117400c03118032195301804019730\n011600000c073000000c043000000c023000000c003000000c073000000c053000000c033000000c013306000c073000000c043000000c023000000c003306000c073000000c053000000c033000000c01330600\n01160000150301203017540120311e032187301704012530150301203017740120311e032185301704012730150301203017540120311e032187301704012530150301203017740120311e0321f5301e0401f730\n001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n01160000157500300015730030001571003000030000300014750030001474003000147300300014710030000c700000000000000000000000000000000000001073003000107401470010750157001076015500\n011600000c7500c7500f7520000011750117501375012700127501255212750007000d750000000c750000000c740000000c730000000c720000000c710000000000000000000000000000000000000000000000\n011600000c7500c7500f7520000011750117501375012700127501250212740007001273000000127100000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},r={init(){if(this.g)return;this.g=!0;const t=window.AudioContext||window.webkitAudioContext;this.u=new t,setTimeout((()=>{this.m=this.u.createGain(this.u,{gain:0}),this.m.connect(this.u.destination),this.m.gain.linearRampToValueAtTime(1,this.u.currentTime+2),this.k=new o(h,{u:this.u}),this.l=this.k.l(),this.l.connect(this.m),this.l.start()}),1)}},a={p:{I:11,v:12,B:13,D:14,T:15,SELECT:25,O:26,C:27,H:28,BACK:29},init(){this.keyboard={},this.pressed={},this.S={},this.V={},this.R={},this.M={ArrowUp:a.p.I,ArrowLeft:a.p.B,ArrowDown:a.p.v,ArrowRight:a.p.D,KeyC:a.p.T,KeyL:a.p.C,KeyH:a.p.H,KeyI:a.p.O,Enter:a.p.SELECT,Escape:a.p.BACK},window.addEventListener("keydown",(t=>{let e=this.M[t.code];e&&(this.keyboard[e]=!0),r.init()})),window.addEventListener("keyup",(t=>{let e=this.M[t.code];e&&(this.keyboard[e]=!1)}))},update(){for(let t of Object.values(a.p)){let e=this.keyboard[t];this.pressed[t]=!this.V[t]&&e,this.S[t]=this.V[t]&&!e,this.pressed[t]?this.R[t]=1:this.V[t]&&e&&this.R[t]++,this.V[t]=e}}},l={W:[{name:"1F",F:[[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,129,129,129,129,129,129,129,134,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,128,46,46,46,46,46,46,137,129,129,129,45,129,129,129,129,134,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,128,46,46,46,46,46,46,124,46,46,46,46,46,46,46,93,128,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,128,46,46,166,46,46,168,137,129,129,129,45,135,129,129,129,131,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,129,129,129,129,129,129,129,138,46,46,46,46,128,32,32,32,133,129,134,32,32,130,129,129,129,45,129,129,138,32],[32,32,32,32,32,32,32,32,32,133,131,46,35,35,46,137,129,135,129,131,37,132,129,129,138,61,61,46,46,46,61,128,32],[32,32,32,32,32,32,32,32,32,128,37,46,35,35,46,128,60,132,46,46,46,46,35,46,128,46,46,46,46,46,46,132,134],[32,32,32,32,32,32,32,32,32,132,134,46,35,35,46,128,46,46,46,46,46,46,46,46,124,46,46,46,46,46,46,37,128],[32,32,32,32,32,32,32,32,32,32,128,46,46,46,46,124,46,46,46,46,46,46,46,46,128,91,93,46,46,38,46,133,131],[32,32,32,32,32,32,32,32,32,32,132,129,129,129,129,138,46,46,46,46,46,46,38,46,137,129,129,145,129,129,129,131,32],[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,132,129,129,129,45,129,129,129,129,131,32,32,32,32,32,32,32,32],[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32]],L:[[33,3,1,8,5],[31,25,5,8,6],[30,10,4,6,7],[32,19,5,3,2],[34,10,2,10,3],[32,15,6,10,6],[31,24,5,4,2],[30,9,6,2,3]],J:[[3,24,8,2],[6,14,4,2],[12,20,6],[14,31,8],[1,15,9,2],[13,10,7],[10,22,7],[5,10,3,2],[7,14,2,2],[17,6,4],[4,19,11,2],[21,16,7],[22,29,9],[8,18,3],[18,25,6],[19,26,6]],Y:[],id:0}],bounds:[[0,0],[33,14]],G:[19,9,0],X:[0,"The lock is broken and the door won't budge. With the right tool, you can\nprobably pry it open.","You wedge the knife between the door and frame. With a little effort, you\nforce the broken lock away from the strike plate.\n%y%0 You push the door open.",0,"The front door has jammed behind you and won't budge.",0,0,"It seems to be locked from the other side.","The charred remnants of a rocking chair.\nA half-burnt notebook is resting on the melted seat cushion.","The charred remnants of a rocking chair.","A vintage dollhouse. Normally you could open it up and take a look inside,\nbut it's been locked with a small silver padlock.","You need some kind of key to open this.","A massive stone fireplace. Above it hangs a portrait of a woman with long,\nstraight black hair. She has one hand on her visibly pregnant belly.\nThe embers are cold.","An impressive granite fireplace. Above the mantle hangs a brightly colored\npainting of a newborn, out of place in such a drab room.\nThe embers are cold.","Above a brick-and-onyx hearth hangs an unpleasant painting of a small child\nbeing devoured whole by a tall, dimly-lit creature. It is hard to look at.\nA knife has been left jammed into the canvas. You can probably pull it out.","With a tug, the painting releases a long iron knife. Hundreds of tiny\nsymbols have been etched up and down the blade, but you don't recognize them.\n%y%0 You have obtained iron knife.","Above a brick-and-onyx hearth hangs an unpleasant painting of a small child\nbeing devoured whole by a tall, dimly-lit creature. It is hard to look at.\nThe embers are cold.","A rusty garage shelf.","The shelf is covered with dust, but not much else.","The shelf seems to have been recently used, most of the dust is wiped off.\nA realistic miniature workbench rests on the shelf.","The shelf seems to have been recently used, most of the dust is wiped off.","The stairs to the second floor are a wreck - you can't go up this way.","A crude, life-sized sculpture of a pregnant woman. One hand rests on her\nbelly, and the other holds an iron knife.\nThe sculpture's grip looks loose - perhaps you could take the knife.","With a tug, the sculpture releases the knife.\n%y%0 You have obtained iron knife.","A crude, life-sized sculpture of a pregnant woman. One hand rests on her\nbelly.",0,0,0,0,0,["DINING ROOM","The dining room is dominated by an oak table, which appears to have been\nused recently as a butcher's block. Flies buzz above fresh animal entrails\nlittering the table. The table and the carpet below is soaked in blood."],["DRAWING ROOM","You are in a dimly lit drawing room filled with faded furniture.\nThe room smells of musty upholstery."],["FOYER","You are in the foyer of the farmhouse. The peeling paint and threadbare\nrugs make it seem older than the outside of the house.\nA large dollhouse sits on a pedestal in the far corner of the room."],["GARAGE","The garage is empty, save for a few rusty shelves and the usual cobwebs.\nThere must have been other furniture here recently, you can see lines\nin the dust where a workbench used to be."],["CHARRED HALLWAY","There must have been a fire at some point. Soot and grime coat the walls,\nand the air stinks of burnt fabric."],["???","A nice old room.\nWhat a nice place it is.\nFuck it."],0,0,0,0,0,["iron knife","A large iron knife etched with\nhundreds of tiny symbols. It feels\nheavy in your hand."],["silver key","A small, delicate silver key."],["your uncle's letter","Dearest Emily,\n\nYou may think me mad but I need\nyour help. We all do. Together\nwe can stop them or it's not\n[the rest is crossed out...]"],["a half-burnt notebook",'Most of the pages are too burnt\nto read, but somehow one page\nis crystal clear:\n\n"Our Goddess walks the hills\n in the shadow of the wailing star\n and we follow in her path"'],["miniature workbench","A curiously realistic miniature\nworkbench, made of wood and metal.\nMaybe there's some use for it."]]},c={j:46,init(){this.reset(),this.K=[]},Z(){if(E.frame%169>1){let t=this.W[0].F;for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length;s++)if(this.W[0].visible[e][s]){let i=this.P({x:s,y:e,z:0});if(i)w.U(s,e,i.char,this.N(i));else{let i=String.fromCharCode(t[e][s]);w.U(s,e,i,this.q(i))}}}if(w.write(0,0," ".repeat(64)),w.write(0,1," ".repeat(64)),w.write(0,2," ".repeat(64)),E.i.$){let t=c.X[E.i.$.id][0];w.write(Math.floor((64-t.length)/2),1,t,w._)}},reset(){this.W=l.W.map((t=>({F:t.F.map((t=>[...t])),visible:t.F.map((t=>t.map((t=>!1)))),J:t.J.map((t=>({id:t[0],x:t[1],y:t[2],type:t[3]}))),L:t.L.map((t=>({id:t[0],x:t[1],y:t[2],width:t[3],height:t[4]}))),Y:t.Y.map((t=>({...t})))}))),this.bounds=l.bounds,this.G=l.G,this.X=l.X;for(let t of this.W)for(let e of t.J)e.char=String.fromCharCode(t.F[e.y][e.x]),t.F[e.y][e.x]=c.j},tt(t){return this.W[t.z].L.find((e=>t.x>=e.x&&t.y>=e.y&&t.x<e.x+e.width&&t.y<e.y+e.height))},P(t){return this.W[t.z].J.find((e=>e.x===t.x&&e.y===t.y))},et(t,e){let s=[];for(let e of this.W)for(let i of e.J)i.id===t&&s.push(i);return e?s.map(e):s},st(t){let e=this.W[t.z].F;return t.x<0||t.y<0||t.x>=e[0].length||t.y>=e.length?" ":e[t.y][t.x]},it(t){return 46===this.st(t)},N:t=>t.finished?w.nt:t.ot?w.ht:w.rt,q:t=>"."===t?w.nt:w.at,lt(t){for(let e of this.W)for(let s of e.L)if(s.id===t)for(let t=s.y;t<s.y+s.height;t++)for(let i=s.x;i<s.x+s.width;i++)e.visible[t][i]=!0}};function f(t,e,s,i){return`rgba(${t},${e},${s},${i})`}function u(t){return(""+t).padStart(3,"0")}const d={init(){this.ct={},this.ct["ft"]=i.o,d.ut=i.o,d.dt=A(d.ut,f(67,255,16,1)),d.At=A(d.ut,f(51,255,0,.4))},wt(t,e,n,o,h=""){"number"==typeof e&&(e=String.fromCharCode(e));let r=this.ct[h];if(r||(this.ct[h]=r=A(i.o,h)),Array.isArray(e))for(let s of e)d.wt(t,s.text,n+1*s.gt,o+1*s.yt,r,1);else for(let i=0;i<e.length;i++){let h=e.charCodeAt(i),a=8*(h-0);32!==h&&t.drawImage(r,1*a%r.width,Math.floor(1*a/r.width)*s*1,8,16,n,o,8,16),n+=8}},bt:(t,e=1)=>t.split("").reduce(((t,e)=>t+8),0)*e,kt(t,e,i){let n=0,o=0,h=()=>({text:"",gt:n,yt:o}),r=h(),a=[];for(let i of t.split("")){let t=d.bt(i,1);if("\n"===i||n+t>e){let t="";if("\n"!==i&&" "!==i){let e=r.text.split(" ");e.length>1&&(t=e.pop(),r.text=e.join(" "))}r.text.length>0&&a.push(r),n=0,o+=s,r=h(),t.length>0&&(r.text=t,n+=d.bt(r.text,1))}else n+=t;"\n"!==i&&(r.text=r.text+i)}return r.text.length>0&&a.push(r),a.map((t=>({...t,w:d.bt(t.text,1),It:s})))}};function A(t,e){let s=function(t,e){let s=document.createElement("canvas");s.width=t,s.height=e;let i=s.getContext("2d");return{canvas:s,vt:i}}(t.width,t.height);return s.vt.fillStyle=e,s.vt.fillRect(0,0,t.width,t.height),s.vt.globalCompositeOperation="destination-in",s.vt.drawImage(t,0,0),s.canvas}const w={nt:0,RED:1,_:2,ht:3,rt:4,Et:5,Bt:6,at:7,Dt:8,Tt:32,init(){this.screen=[],this.Ot=5,this.clear(),w.Qt={[w.nt]:f(144,144,144,1),[w.RED]:f(214,69,46,1),[w._]:f(151,216,122,1),[w.ht]:f(238,212,83,1),[w.rt]:f(70,151,226,1),[w.at]:f(214,214,214,1),[w.at|w.Dt]:f(255,255,255,1)}},clear(t=0,s=0,i=80,n=24){for(let o=s;o<s+n;o++)for(let s=t;s<t+i;s++)this.screen[o*e+s]=w.Tt|w.at<<8},write(t,s,i,n=w.at,o=80){if("string"!=typeof i)throw new Error("string");let h=t;for(let r=0;r<i.length;r++){let a=i.charCodeAt(r);if("\n"!==i[r]){if("%"===i[r])switch(i[++r]){case"d":n=w.nt;continue;case"r":n=w.RED;continue;case"g":n=w._;continue;case"b":n=w.rt;continue;case"y":n=w.ht;continue;case"w":n=w.at;continue;case"W":n=w.at|w.Dt;continue;case"0":a=165;break;case"1":a=164;break;default:r--}this.screen[s*e+t]=a|n<<8,++t>=o&&(t=h,s++)}else t=h,s++}},Ct(t,e,s,i){i>0&&(s=s.slice(0,0|i),this.write(t,e,s))},U(e,s,i,n,o){let h=32-t.t.x,r=12-t.t.y;this.write(e+h,s+r,i,n,o)},Ht(t,e,s,i,n){s>2&&i>2&&w.clear(t+1,e+1,s-2,i-2),this.write(t,e,`${"".repeat(s-2)}`,n),this.write(t,e+i-1,`${"".repeat(s-2)}`,n);for(let o=e+1;o<e+i-1;o++)this.write(t,o,"",n),this.write(t+s-1,o,"",n)},Z(t){if(E.frame%221>0)for(let i=0;i<24;i++)for(let n=0;n<e;n++){let o=this.screen[i*e+n],h=255&o;32!==h&&h<128&&(h+=this.Ot),d.wt(t,h,8*n,i*s,w.Qt[o>>8])}}},g={init(){this.entries=[]},add(t,e=""){console.log(t),"%"!==t[0]&&(t=e+"¥ "+t),this.entries.push(t.split("\n"))},St(t){g.add(`%y%0 You have obtained ${c.X[t][0]}.`)},Z(t=3){let e=t+2,s=22-t,i=0;this.entries[this.entries.length-1].length<3&&(i=3-this.entries[this.entries.length-1].length);let n=this.entries.flat();for(;i-- >0;)n.push("");n.length>t&&(n=n.slice(n.length-t)),w.Ht(0,s,80,e,w.nt),w.write(64,s,"",w.nt);for(let t=0;t<n.length;t++)w.write(2,s+t+1,n[t])}};class y{constructor(){this.lines=3,this.offset=0}update(){if((a.pressed[a.p.BACK]||a.pressed[a.p.C])&&(this.Vt=!0),this.Vt){if(this.lines-=2,this.lines<=3)return void(this.Rt=!0)}else this.lines<15&&(this.lines+=2),a.pressed[a.p.I]?this.offset++:a.pressed[a.p.v]&&this.offset--;this.offset=Math.min(this.offset,0),this.offset=Math.max(this.offset,g.entries.flat().length-this.lines)}Z(){w.clear(0,24-this.lines-1,e,this.lines+2),g.Z(this.lines,this.offset)}}class m{constructor(){this.expand=2}update(){if((a.pressed[a.p.BACK]||a.pressed[a.p.H])&&(this.Vt=!0),this.Vt){if(this.expand-=2,2===this.expand)return void(this.Rt=!0)}else this.expand<22&&(this.expand+=2)}Z(){const t="                                  %gHELP\n\n%gCONTROLS\n  %W ¡¢£    %wMove / Investigate / Attack\n  %WI       %wOpen inventory\n  %WL       %wExpand logbook\n  %WH       %wToggle help (this screen)\n\n%gMAP LEGEND\n  %W@       %wYou\n  %d.       %wEmpty floors\n  %w      %wWalls\n  %b|- %d'    %wDoors (%bclosed%w / %dopen%w)\n  %b< >     %wStairways (up / down)\n\n  %b&!      %wBlue objects can be investigated\n  %y%#      %wYellow objects may need to be revisited later\n  %d=$      %wGray objects have already been investigated\n\n  %rsfVH    %wRed letters are foes";w.Ht(2,12-Math.floor(this.expand/2),76,this.expand,w._),w.write(4,13-Math.floor(this.expand/2),t.split("\n").slice(0,this.expand).join("\n"))}}class b{constructor(t){this.object=t,this.expand=2,this.selected=0,this.list=E.i.Mt}update(){console.log(["update",a.pressed[a.p.v]]),a.pressed[a.p.BACK]||a.pressed[a.p.O]&&!this.object?this.Vt=!0:a.pressed[a.p.v]?this.selected=(this.selected+1)%this.list.length:a.pressed[a.p.I]?this.selected=(this.selected+this.list.length-1)%this.list.length:a.pressed[a.p.SELECT]&&this.object&&(this.Vt=!0,E.i.zt(this.object,this.list[this.selected])),this.Vt&&(this.Rt=!0)}Z(){w.Ht(5,6,71,10,w._),w.write(38,6,"",w._),w.write(38,15,"",w._);for(let t=7;t<15;t++)w.write(38,t,"",w._);for(let t=0;t<this.list.length;t++){let[e,s]=c.X[this.list[t]];t===this.selected?(w.write(6,7+t,`%0${e.padEnd(30)}%1`,w._),w.write(40,7,s)):w.write(7,7+t,e)}this.object?w.write(6,14,"[ ¡¢£ENTER] Use item  [ESC] Back",w.nt):w.write(6,14,"[ ¡¢£] Examine item   [ESC] Back",w.nt)}}class k{constructor(t){this.t={...t},this.Wt=this.$,this.Mt=[],this.speed=4,this.Ft=this.Lt=100,this.Jt=this.Yt=100,this.Gt(43),c.et(4,(t=>t.finished=!0)),this.$=c.tt(this.t),g.add(c.X[this.$.id][1]),c.lt(this.$.id),this.Gt(41),this.Gt(44)}Z(){w.U(this.t.x,this.t.y,"@",w.at|w.Dt)}update(){let t;return console.log(a.V[a.p.B],a.R[a.p.B]),a.V[a.p.B]&&a.R[a.p.B]%2==1?t={...this.t,x:this.t.x-1}:a.V[a.p.D]&&a.R[a.p.D]%2==1?t={...this.t,x:this.t.x+1}:a.V[a.p.I]&&a.R[a.p.I]%2==1?t={...this.t,y:this.t.y-1}:a.V[a.p.v]&&a.R[a.p.v]%2==1&&(t={...this.t,y:this.t.y+1}),t&&this.xt(t),!!t}xt(t){let e=c.st(t),s=c.P(t);if(E.Xt(t));else if(s){if(s.open)this.jt(t,!1);else if(s.finished)this.Wt=s,g.add(c.X[s.id]),console.log("finished"+c.X[s.id]);else if(1===s.id)g.add(c.X[s.id]),s.ot&&this.Kt(s);else if(3===s.id)this.Zt(s),c.lt(31);else if(7===s.id)g.add(c.X[s.id]);else if(5===s.id)this.Zt(s),c.lt(33);else if(6===s.id)this.Zt(s),c.lt(34);else if(8===s.id)g.add(c.X[s.id]),s.id=9;else if(9===s.id)s.finished=!0,g.St(44),this.Gt(44);else if(14===s.id)g.add(c.X[s.id]),s.id=15;else if(15===s.id)g.add(c.X[s.id]),s.id=16,this.Gt(41);else if(17===s.id)g.add(c.X[s.id]),s.finished=!0,this.Gt(42);else if(18===s.id)g.add(c.X[s.id]),s.finished=!0;else if(19===s.id)g.add(c.X[s.id]),s.id=20;else if(20===s.id)s.finished=!0,g.St(45),this.Gt(45);else if(22===s.id)g.add(c.X[s.id]),s.id=23;else if(23===s.id)g.add(c.X[s.id]),s.id=24,s.finished=!0,this.Gt(41);else if(21===s.id)g.add(c.X[s.id]),s.finished=!0;else if(2===s.type)this.Zt(s);else{let t="";s.action?t=`\n${s.action}`:s.ot&&(t="\n%y¥ You need some kind of other item."),this.Wt=s,console.log(s.id),console.log(c.X[s.id]+t),g.add(c.X[s.id]+t),console.log("else statement"+c.X[s.id])}s.ot=!0}else e===c.j?this.jt(t,!0):console.log("No.")}jt(t,e){if(this.t=t,e){let t=c.tt(this.t);this.$!==t&&g.add(c.X[t.id][1]),this.$=t,this.Wt=this.$}}Kt(t){E.Pt.push(new b(t))}zt(t,e){1===t.id&&(41===e?(this.Zt(t,2),c.lt(30)):g.add("That doesn't work here.","%y")),console.log("oh fuck, i am using "+t+e)}Ut(t){return this.Mt.includes(t)}Gt(t){this.Mt.push(t)}Zt(t,e){e?g.add(c.X[e]):g.add("You push the door open.","%y"),t.open=t.finished=!0,t.char="|"===t.char?"'":""}}const p={Nt(){const t=[...E.entities];if(E.i.qt||(E.i.qt=0),E.i.qt>=E.i.speed){E.i.update()&&(E.i.qt-=E.i.speed);for(let e of t)e.speed||e.update()}else for(let e of t)for(e.qt=(e.qt||0)+1;e.qt>=e.speed&&e!==E.i;)e.update(),e.qt-=e.speed}},I={init(){I.canvas=document.getElementById("canvas"),I.vt=I.canvas.getContext("2d"),I.resize(!0)},resize(t){let e=window.devicePixelRatio,s=I.canvas.clientWidth,i=I.canvas.clientHeight,n=s*e,o=i*e;(t||I.canvas.width!==n||I.canvas.height!==o)&&(I.canvas.width=n,I.canvas.height=o,I.scale=(10*Math.min(n/648,o/400)|0)/10,I.width=Math.ceil(n/I.scale),I.height=Math.ceil(o/I.scale),I.$t={gt:I.width/2|0,yt:I.height/2|0},I.clientWidth=s,I.clientHeight=i,I.vt.imageSmoothingEnabled=!1),I.canvas.style.cursor="not-allowed"}};class v{constructor(){this.expand=2,w.Ot=26}update(){(a.pressed[a.p.SELECT]||r.g)&&(this.Vt=!0),this.Vt&&(this.Rt=!0,w.Ot=8)}Z(){w.clear(),w.Ht(4,4,72,15,w._),w.write(6,5,"                     %gSHADOW OF THE KEENING STAR\n\n%wFor some reason, you just couldn't ignore that letter. It was wrong,\nsomehow - although estranged, you remember your uncle, and he never\nwrote like that.\n\nSo here you are, an hour southeast of Boston, still clutching your\nuncle's letter and standing in front of a weather-beaten colonial.\n\nThe creak of the front door echoes in your ears as you step into the\nhouse...\n\n%d[ENTER] Begin")}}const E={async init(){await i.init(),I.init(),w.init(),d.init(),a.init(),c.init(),g.init(),this.frame=0,this.entities=[],this.i=new k(function(t,e,s){return{x:t,y:e,z:s}}(...c.G)),this.entities.push(this.i),this.Pt=[],this.Pt.push(new v),t.init(),window.requestAnimationFrame((()=>this._t()))},_t(){let t=(new Date).getTime();t-(this.te||0)>=1e3/60&&(this.frame++,this.update(),this.te=t,I.resize(),this.Z()),window.requestAnimationFrame((()=>this._t()))},update(){a.update(),this.Pt.length>0?(this.Pt[this.Pt.length-1].update(),this.Pt=this.Pt.filter((t=>!t.Rt))):a.pressed[a.p.C]?this.Pt.push(new y):a.pressed[a.p.H]?this.Pt.push(new m):a.pressed[a.p.O]?(this.Pt.push(new b),console.log("inv")):p.Nt(),t.update(),E.entities=E.entities.filter((t=>!t.Rt)),w.Ot>0&&w.Ot--},Z(){I.vt.setTransform(I.scale,0,0,I.scale,0,0),I.vt.fillStyle="#121212",I.vt.fillRect(0,0,I.width,I.height),I.vt.translate((I.width-648)/2|0,(I.height-400)/2|0),w.clear();for(let t=0;t<Math.min(20,this.frame/3);t++)w.write(64,t,"",w.nt);w.Ct(66,1,`Health ${u(E.i.Ft)}/${u(E.i.Lt)}`,this.frame/2),w.Ct(66,2,`Sanity ${u(E.i.Jt)}/${u(E.i.Yt)}`,this.frame/2-10),c.Z();for(let t of this.entities)t.z<0&&t.Z();for(let t of this.entities)t.z||t.Z();for(let t of this.entities)t.z>0&&t.Z();this.frame>60&&(w.write(66,18,"[H] Help",w.nt),g.Z(3));for(let t of this.Pt)t.Z();w.Z(I.vt)},Xt(t){return this.entities.find((e=>e.t.x===t.x&&e.t.y===t.y&&e.t.z===t.z))}};E.init()}();
//# sourceMappingURL=app.js.map</script>